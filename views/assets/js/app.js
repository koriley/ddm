"use strict";

function updateAbilityBonus(myAbility) {
  var ability = jQuery(myAbility).val();
  var modifier = jQuery(myAbility).parent().children('.modifier-bubble').text();

  if (!jQuery.isNumeric(ability)) {
    ability = 1;
    jQuery(myAbility).val(ability);
  }

  modifier = Math.floor((ability - 10) / 2);
  jQuery(myAbility).parent().children('.modifier-bubble').text(modifier);

  if (myAbility.attr('id') == 'wis') {
    passivePerception();
  }
}

;
jQuery(".ability").each(function () {
  updateAbilityBonus(jQuery(this));
  jQuery(this).on("focus", function () {
    jQuery(this).select();
  });
  jQuery(this).on("keyup", function () {
    updateAbilityBonus(jQuery(this));
    updateProf(jQuery('.savingThrows #' + jQuery(this).attr('id')));
  });
});
'use strict'; //remove line below when testing frontend
// var fs = require('fs');
//////////////////

jQuery("document").ready(function () {
  jQuery(".drag").draggable({
    containment: ".mainView",
    scroll: false
  });
  jQuery(".resize").resizable({
    containment: ".mainView",
    autoHide: true,
    distance: 1,
    handles: 'se'
  });
  passivePerception();
}); //
// var books = {};
// readAFile("./books/dmg.json").then((book) => {
//     var bookTitle = JSON.parse(book);
//
//     console.log(bookTitle.details.name);
// });
"use strict";

var thisAbility = "";
var thisAbilityBonus = "";

function callAbility(ability) {
  thisAbility = jQuery('.ability-box #' + ability).val();
  thisAbilityBonus = parseInt(jQuery('.ability-box #' + ability + '-Bonus').text());
}
"use strict";

function abrreviateLabels() {
  var abbrWords = ['Speed|Spd', 'Initiative|Init ', 'Temporary |Temp ', 'Hit Points|HP', 'Armor Class|AC'];
  var mySize = jQuery('.charSheet').css('font-size');
  mySize = parseInt(mySize.split('px')[0]); // console.log(mySize);

  if (mySize < 16) {
    jQuery('.stat label').each(function (index, label) {
      jQuery(abbrWords).each(function (index, word) {
        var long = word.split('|')[0];
        var short = word.split('|')[1];
        jQuery(label).text(function (index, text) {
          return text.replace(long, short);
        });
      });
    });
  } else {
    jQuery('.stat label').each(function (index, label) {
      jQuery(abbrWords).each(function (index, word) {
        var long = word.split('|')[0];
        var short = word.split('|')[1];
        jQuery(label).text(function (index, text) {
          return text.replace(short, long);
        });
      });
    });
  }
}
"use strict";

function clearTop() {
  jQuery(".drag").each(function () {
    jQuery(this).removeClass("onTop");
  });
}

;
jQuery(".drag").on("mousedown", function () {
  clearTop();
  jQuery(this).addClass("onTop");
});
'use strict';

function readAFile(filepath) {
  return new Promise(function (resolve, reject) {
    fs.readFile(filepath, 'utf-8', function (err, data) {
      if (err) {
        reject("An error ocurred reading the file :" + err.message);
        return;
      } else {
        resolve(data);
      }
    });
  });
}

function writeFile(filepath, data) {
  return new Promise(function (resolve, reject) {
    fs.writeFile(filepath, data, function (err) {
      if (err) {
        reject(err);
      }
    });
  });
} //write test
// var testObj  = "This is a write test";
// writeFile("../test.txt", testObj);
"use strict";

jQuery(".close").click(function () {
  jQuery(this).parent().toggle();
});
jQuery(".menu .players-btn").click(function () {
  jQuery(".charSheet").toggle();
  clearTop();
  jQuery(".charSheet").addClass("onTop");
});
jQuery(".menu .library-btn").click(function () {
  jQuery(".library-container").toggle();
  clearTop();
  jQuery(".library-container").addClass("onTop");
});
jQuery(".menu .themes-btn").click(function () {
  jQuery(".themes-container").toggle();
  clearTop();
  jQuery(".themes-container").addClass("onTop");
});
jQuery(".menu .attribution-btn").click(function () {
  jQuery(".attribution-container").toggle();
  clearTop();
  jQuery(".attribution-container").addClass("onTop");
});
"use strict";

function passivePerception() {
  callAbility('wis');
  jQuery('#passPerc').val(thisAbilityBonus + 10);
}
"use strict";

var profB = jQuery('#profBonus').val();
somethingClever();
jQuery('#profBonus').on("keyup", function () {
  profB = jQuery('#profBonus').val();
  somethingClever();
});

function somethingClever() {
  jQuery('.icon-prof').each(function () {
    var classes = ['icon-prof', 'icon-prof proficient', 'icon-prof expertise'];
    var currentClass = jQuery(this).attr('class');
    var currentPos = jQuery.inArray(currentClass, classes);
    var myProf = jQuery(this).parent().children('.profVal');
    updateProf(jQuery(myProf), currentPos);
  });
}

function updateProf(myProf, myProfSkillFlag) {
  var thisAbility = jQuery(myProf).attr('id');
  var thisAbilityBonusID = '#' + thisAbility + '-Bonus';
  var thisAbilityBonus = jQuery('.abilities ' + thisAbilityBonusID).text();
  var newVal = parseInt(thisAbilityBonus);

  if (myProfSkillFlag == 0) {
    var newVal = parseInt(thisAbilityBonus);
  }

  if (myProfSkillFlag == 1) {
    var newVal = parseInt(profB) + parseInt(thisAbilityBonus);
  }

  if (myProfSkillFlag == 2) {
    var newVal = parseInt(profB) * 2 + parseInt(thisAbilityBonus);
  }

  jQuery(myProf).text(newVal);
}

;
jQuery('.icon-prof').click(function () {
  var classes = ['icon-prof', 'icon-prof proficient', 'icon-prof expertise'];
  var currentClass = jQuery(this).attr('class');
  var currentPos = jQuery.inArray(currentClass, classes);
  var newPos = (currentPos + 1) % classes.length;
  var newClass = classes[newPos];
  jQuery(this).attr('class', newClass);
  var myProf = jQuery(this).parent().children('.profVal');
  updateProf(jQuery(myProf), newPos);
});
"use strict";

abrreviateLabels();
jQuery('.textSize #font-size-up').click(function () {
  var target = jQuery(this).parent().parent();
  var currSize = parseInt(jQuery(target).css('fontSize').split("px")[0]); // currSize = Math.round(currSize);

  var newSize = currSize + 1;

  if (newSize > 24) {
    newSize = 24;
  }

  var newEms = newSize / 16;
  console.log(currSize + ':' + newSize + ':' + newEms);
  jQuery(target).css('fontSize', newEms + 'em');
  abrreviateLabels();
});
jQuery('.textSize #font-size-down').click(function () {
  var target = jQuery(this).parent().parent();
  var currSize = parseInt(jQuery(target).css('fontSize').split("px")[0]);
  var newSize = currSize - 1;

  if (newSize < 9) {
    newSize = 9;
  }

  var newEms = newSize / 16;
  console.log(currSize + ':' + newSize + ':' + newEms);
  jQuery(target).css('fontSize', newEms + 'em');
  abrreviateLabels();
});
"use strict";

//themes
var buttonOptions = ['default', 'worn', 'light', 'black', 'gray', 'red'];
jQuery(buttonOptions).each(function () {
  var myStyle = this;
  var myId = '#' + myStyle;
  jQuery(myId).on("click", function () {
    $("body").removeAttr('class');
    jQuery('body').addClass('theme-' + myStyle);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFiaWxpdHlCb251cy5qcyIsImFwcC5qcyIsImNhbGxBYmlsaXR5LmpzIiwiY2hhclNoZWV0QWJicmV2aWF0ZS5qcyIsImNsaWNrVG9Gcm9udC5qcyIsImlvLmpzIiwibWVudUJ1dHRvbnMuanMiLCJwYXNzaXZlUGVyY2VwdGlvbi5qcyIsInByb2ZpY2llbmNpZXMuanMiLCJ0ZXh0U2l6ZS5qcyIsInRoZW1lcy5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVBYmlsaXR5Qm9udXMiLCJteUFiaWxpdHkiLCJhYmlsaXR5IiwialF1ZXJ5IiwidmFsIiwibW9kaWZpZXIiLCJwYXJlbnQiLCJjaGlsZHJlbiIsInRleHQiLCJpc051bWVyaWMiLCJNYXRoIiwiZmxvb3IiLCJhdHRyIiwicGFzc2l2ZVBlcmNlcHRpb24iLCJlYWNoIiwib24iLCJzZWxlY3QiLCJ1cGRhdGVQcm9mIiwicmVhZHkiLCJkcmFnZ2FibGUiLCJjb250YWlubWVudCIsInNjcm9sbCIsInJlc2l6YWJsZSIsImF1dG9IaWRlIiwiZGlzdGFuY2UiLCJoYW5kbGVzIiwidGhpc0FiaWxpdHkiLCJ0aGlzQWJpbGl0eUJvbnVzIiwiY2FsbEFiaWxpdHkiLCJwYXJzZUludCIsImFicnJldmlhdGVMYWJlbHMiLCJhYmJyV29yZHMiLCJteVNpemUiLCJjc3MiLCJzcGxpdCIsImluZGV4IiwibGFiZWwiLCJ3b3JkIiwibG9uZyIsInNob3J0IiwicmVwbGFjZSIsImNsZWFyVG9wIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInJlYWRBRmlsZSIsImZpbGVwYXRoIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmcyIsInJlYWRGaWxlIiwiZXJyIiwiZGF0YSIsIm1lc3NhZ2UiLCJ3cml0ZUZpbGUiLCJjbGljayIsInRvZ2dsZSIsInByb2ZCIiwic29tZXRoaW5nQ2xldmVyIiwiY2xhc3NlcyIsImN1cnJlbnRDbGFzcyIsImN1cnJlbnRQb3MiLCJpbkFycmF5IiwibXlQcm9mIiwibXlQcm9mU2tpbGxGbGFnIiwidGhpc0FiaWxpdHlCb251c0lEIiwibmV3VmFsIiwibmV3UG9zIiwibGVuZ3RoIiwibmV3Q2xhc3MiLCJ0YXJnZXQiLCJjdXJyU2l6ZSIsIm5ld1NpemUiLCJuZXdFbXMiLCJjb25zb2xlIiwibG9nIiwiYnV0dG9uT3B0aW9ucyIsIm15U3R5bGUiLCJteUlkIiwiJCIsInJlbW92ZUF0dHIiXSwibWFwcGluZ3MiOiI7O0FBQ0EsU0FBU0Esa0JBQVQsQ0FBNEJDLFNBQTVCLEVBQXVDO0FBQ25DLE1BQUlDLE9BQU8sR0FBR0MsTUFBTSxDQUFDRixTQUFELENBQU4sQ0FBa0JHLEdBQWxCLEVBQWQ7QUFFQSxNQUFJQyxRQUFRLEdBQUdGLE1BQU0sQ0FBQ0YsU0FBRCxDQUFOLENBQWtCSyxNQUFsQixHQUEyQkMsUUFBM0IsQ0FBb0Msa0JBQXBDLEVBQXdEQyxJQUF4RCxFQUFmOztBQUNBLE1BQUksQ0FBQ0wsTUFBTSxDQUFDTSxTQUFQLENBQWlCUCxPQUFqQixDQUFMLEVBQWdDO0FBQzVCQSxJQUFBQSxPQUFPLEdBQUcsQ0FBVjtBQUNBQyxJQUFBQSxNQUFNLENBQUNGLFNBQUQsQ0FBTixDQUFrQkcsR0FBbEIsQ0FBc0JGLE9BQXRCO0FBR0g7O0FBRURHLEVBQUFBLFFBQVEsR0FBR0ssSUFBSSxDQUFDQyxLQUFMLENBQVcsQ0FBQ1QsT0FBTyxHQUFHLEVBQVgsSUFBaUIsQ0FBNUIsQ0FBWDtBQUNBQyxFQUFBQSxNQUFNLENBQUNGLFNBQUQsQ0FBTixDQUFrQkssTUFBbEIsR0FBMkJDLFFBQTNCLENBQW9DLGtCQUFwQyxFQUF3REMsSUFBeEQsQ0FBNkRILFFBQTdEOztBQUVBLE1BQUlKLFNBQVMsQ0FBQ1csSUFBVixDQUFlLElBQWYsS0FBd0IsS0FBNUIsRUFBbUM7QUFDL0JDLElBQUFBLGlCQUFpQjtBQUNwQjtBQUNKOztBQUFBO0FBR0RWLE1BQU0sQ0FBQyxVQUFELENBQU4sQ0FBbUJXLElBQW5CLENBQXdCLFlBQVc7QUFDL0JkLEVBQUFBLGtCQUFrQixDQUFDRyxNQUFNLENBQUMsSUFBRCxDQUFQLENB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QUFRLEdBQUMsQ0FBdkI7O0FBQ0EsTUFBSUMsT0FBTyxHQUFHLENBQWQsRUFBZ0I7QUFDWkEsSUFBQUEsT0FBTyxHQUFHLENBQVY7QUFDSDs7QUFDRCxNQUFJQyxNQUFNLEdBQUlELE9BQU8sR0FBQyxFQUF0QjtBQUNBRSxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosUUFBUSxHQUFDLEdBQVQsR0FBYUMsT0FBYixHQUFxQixHQUFyQixHQUF5QkMsTUFBckM7QUFDQXRFLEVBQUFBLE1BQU0sQ0FBQ21FLE1BQUQsQ0FBTixDQUFlckMsR0FBZixDQUFtQixVQUFuQixFQUE4QndDLE1BQU0sR0FBQyxJQUFyQztBQUNBM0MsRUFBQUEsZ0JBQWdCO0FBQ25CLENBWEQ7OztBQ2ZBO0FBQ0EsSUFBSThDLGFBQWEsR0FBRyxDQUFDLFNBQUQsRUFBWSxNQUFaLEVBQW9CLE9BQXBCLEVBQTZCLE9BQTdCLEVBQXNDLE1BQXRDLEVBQThDLEtBQTlDLENBQXBCO0FBQ0F6RSxNQUFNLENBQUN5RSxhQUFELENBQU4sQ0FBc0I5RCxJQUF0QixDQUEyQixZQUFXO0FBQ2xDLE1BQUkrRCxPQUFPLEdBQUcsSUFBZDtBQUNBLE1BQUlDLElBQUksR0FBRyxNQUFNRCxPQUFqQjtBQUNBMUUsRUFBQUEsTUFBTSxDQUFDMkUsSUFBRCxDQUFOLENBQWEvRCxFQUFiLENBQWdCLE9BQWhCLEVBQXlCLFlBQVc7QUFDaENnRSxJQUFBQSxDQUFDLENBQUMsTUFBRCxDQUFELENBQVVDLFVBQVYsQ0FBcUIsT0FBckI7QUFDQTdFLElBQUFBLE1BQU0sQ0FBQyxNQUFELENBQU4sQ0FBZXdDLFFBQWYsQ0FBd0IsV0FBV2tDLE9BQW5DO0FBQ0gsR0FIRDtBQUlILENBUEQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5mdW5jdGlvbiB1cGRhdGVBYmlsaXR5Qm9udXMobXlBYmlsaXR5KSB7XG4gICAgdmFyIGFiaWxpdHkgPSBqUXVlcnkobXlBYmlsaXR5KS52YWwoKTtcblxuICAgIHZhciBtb2RpZmllciA9IGpRdWVyeShteUFiaWxpdHkpLnBhcmVudCgpLmNoaWxkcmVuKCcubW9kaWZpZXItYnViYmxlJykudGV4dCgpO1xuICAgIGlmICghalF1ZXJ5LmlzTnVtZXJpYyhhYmlsaXR5KSkge1xuICAgICAgICBhYmlsaXR5ID0gMTtcbiAgICAgICAgalF1ZXJ5KG15QWJpbGl0eSkudmFsKGFiaWxpdHkpO1xuXG5cbiAgICB9XG5cbiAgICBtb2RpZmllciA9IE1hdGguZmxvb3IoKGFiaWxpdHkgLSAxMCkgLyAyKTtcbiAgICBqUXVlcnkobXlBYmlsaXR5KS5wYXJlbnQoKS5jaGlsZHJlbignLm1vZGlmaWVyLWJ1YmJsZScpLnRleHQobW9kaWZpZXIpO1xuICAgIFxuICAgIGlmIChteUFiaWxpdHkuYXR0cignaWQnKSA9PSAnd2lzJykge1xuICAgICAgICBwYXNzaXZlUGVyY2VwdGlvbigpO1xuICAgIH1cbn07XG5cblxualF1ZXJ5KFwiLmFiaWxpdHlcIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICB1cGRhdGVBYmlsaXR5Qm9udXMoalF1ZXJ5KHRoaXMpKTtcblxuICAgIGpRdWVyeSh0aGlzKS5vbihcImZvY3VzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBqUXVlcnkodGhpcykuc2VsZWN0KCk7XG4gICAgfSlcbiAgICBqUXVlcnkodGhpcykub24oXCJrZXl1cFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdXBkYXRlQWJpbGl0eUJvbnVzKGpRdWVyeSh0aGlzKSk7XG4gICAgICAgIHVwZGF0ZVByb2YoalF1ZXJ5KCcuc2F2aW5nVGhyb3dzICMnK2pRdWVyeSh0aGlzKS5hdHRyKCdpZCcpKSk7XG4gICAgfSk7XG59KTtcbiIsIid1c2Ugc3RyaWN0Jztcbi8vcmVtb3ZlIGxpbmUgYmVsb3cgd2hlbiB0ZXN0aW5nIGZyb250ZW5kXG4vLyB2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xuLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmpRdWVyeShcImRvY3VtZW50XCIpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICBqUXVlcnkoXCIuZHJhZ1wiKS5kcmFnZ2FibGUoe1xuICAgICAgICBjb250YWlubWVudDogXCIubWFpblZpZXdcIixcbiAgICAgICAgc2Nyb2xsOiBmYWxzZVxuICAgIH0pO1xuXG4gICAgalF1ZXJ5KCBcIi5yZXNpemVcIiApLnJlc2l6YWJsZSh7XG4gICAgICAgIGNvbnRhaW5tZW50OiBcIi5tYWluVmlld1wiLFxuICAgICAgICBhdXRvSGlkZTogdHJ1ZSxcbiAgICAgICAgZGlzdGFuY2U6IDEsXG4gICAgICAgIGhhbmRsZXM6ICdzZSdcbiAgICB9KTtcblxuICAgIHBhc3NpdmVQZXJjZXB0aW9uKCk7XG59KTtcbi8vXG4vLyB2YXIgYm9va3MgPSB7fTtcbi8vIHJlYWRBRmlsZShcIi4vYm9va3MvZG1nLmpzb25cIikudGhlbigoYm9vaykgPT4ge1xuLy8gICAgIHZhciBib29rVGl0bGUgPSBKU09OLnBhcnNlKGJvb2spO1xuLy9cbi8vICAgICBjb25zb2xlLmxvZyhib29rVGl0bGUuZGV0YWlscy5uYW1lKTtcbi8vIH0pO1xuIiwidmFyIHRoaXNBYmlsaXR5ID0gXCJcIjtcbnZhciB0aGlzQWJpbGl0eUJvbnVzID0gXCJcIjtcblxuZnVuY3Rpb24gY2FsbEFiaWxpdHkoYWJpbGl0eSkge1xuICAgIHRoaXNBYmlsaXR5ID0galF1ZXJ5KCcuYWJpbGl0eS1ib3ggIycrYWJpbGl0eSkudmFsKCk7XG4gICAgdGhpc0FiaWxpdHlCb251cyA9IHBhcnNlSW50KGpRdWVyeSgnLmFiaWxpdHktYm94ICMnK2FiaWxpdHkrJy1Cb251cycpLnRleHQoKSk7XG59XG4iLCJmdW5jdGlvbiBhYnJyZXZpYXRlTGFiZWxzKCkge1xuICAgIHZhciBhYmJyV29yZHMgPSBbJ1NwZWVkfFNwZCcsJ0luaXRpYXRpdmV8SW5pdCAnLCdUZW1wb3JhcnkgfFRlbXAgJywnSGl0IFBvaW50c3xIUCcsJ0FybW9yIENsYXNzfEFDJ107XG4gICAgdmFyIG15U2l6ZSA9IGpRdWVyeSgnLmNoYXJTaGVldCcpLmNzcygnZm9udC1zaXplJyk7XG4gICAgbXlTaXplID0gcGFyc2VJbnQobXlTaXplLnNwbGl0KCdweCcpWzBdKTtcbiAgICAvLyBjb25zb2xlLmxvZyhteVNpemUpO1xuICAgIGlmIChteVNpemU8MTYpIHtcbiAgICAgICAgalF1ZXJ5KCcuc3RhdCBsYWJlbCcpLmVhY2goIGZ1bmN0aW9uKGluZGV4LCBsYWJlbCkge1xuICAgICAgICAgICAgalF1ZXJ5KGFiYnJXb3JkcykuZWFjaCggZnVuY3Rpb24oaW5kZXgsIHdvcmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9uZyA9IHdvcmQuc3BsaXQoJ3wnKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc2hvcnQgPSB3b3JkLnNwbGl0KCd8JylbMV07XG4gICAgICAgICAgICAgICAgalF1ZXJ5KGxhYmVsKS50ZXh0KGZ1bmN0aW9uKGluZGV4LCB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UobG9uZywgc2hvcnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgalF1ZXJ5KCcuc3RhdCBsYWJlbCcpLmVhY2goIGZ1bmN0aW9uKGluZGV4LCBsYWJlbCkge1xuICAgICAgICAgICAgalF1ZXJ5KGFiYnJXb3JkcykuZWFjaCggZnVuY3Rpb24oaW5kZXgsIHdvcmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9uZyA9IHdvcmQuc3BsaXQoJ3wnKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc2hvcnQgPSB3b3JkLnNwbGl0KCd8JylbMV07XG4gICAgICAgICAgICAgICAgalF1ZXJ5KGxhYmVsKS50ZXh0KGZ1bmN0aW9uKGluZGV4LCB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2Uoc2hvcnQsIGxvbmcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxufVxuIiwiZnVuY3Rpb24gY2xlYXJUb3AoKSB7XG4gICAgalF1ZXJ5KFwiLmRyYWdcIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgalF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKFwib25Ub3BcIik7XG4gICAgfSk7XG59O1xuXG5qUXVlcnkoXCIuZHJhZ1wiKS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRvcCgpO1xuICAgIGpRdWVyeSh0aGlzKS5hZGRDbGFzcyhcIm9uVG9wXCIpO1xufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIHJlYWRBRmlsZShmaWxlcGF0aCl7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgZnMucmVhZEZpbGUoZmlsZXBhdGgsICd1dGYtOCcsIGZ1bmN0aW9uKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIkFuIGVycm9yIG9jdXJyZWQgcmVhZGluZyB0aGUgZmlsZSA6XCIgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gd3JpdGVGaWxlKGZpbGVwYXRoLCBkYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGZzLndyaXRlRmlsZShmaWxlcGF0aCwgZGF0YSwgKGVycikgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbn1cblxuLy93cml0ZSB0ZXN0XG4vLyB2YXIgdGVzdE9iaiAgPSBcIlRoaXMgaXMgYSB3cml0ZSB0ZXN0XCI7XG4vLyB3cml0ZUZpbGUoXCIuLi90ZXN0LnR4dFwiLCB0ZXN0T2JqKTtcbiIsIlxualF1ZXJ5KFwiLmNsb3NlXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgalF1ZXJ5KHRoaXMpLnBhcmVudCgpLnRvZ2dsZSgpO1xufSlcbmpRdWVyeShcIi5tZW51IC5wbGF5ZXJzLWJ0blwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgIGpRdWVyeShcIi5jaGFyU2hlZXRcIikudG9nZ2xlKCk7XG4gICAgY2xlYXJUb3AoKTtcbiAgICBqUXVlcnkoXCIuY2hhclNoZWV0XCIpLmFkZENsYXNzKFwib25Ub3BcIik7XG59KVxuXG5qUXVlcnkoXCIubWVudSAubGlicmFyeS1idG5cIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgICBqUXVlcnkoXCIubGlicmFyeS1jb250YWluZXJcIikudG9nZ2xlKCk7XG4gICAgY2xlYXJUb3AoKTtcbiAgICBqUXVlcnkoXCIubGlicmFyeS1jb250YWluZXJcIikuYWRkQ2xhc3MoXCJvblRvcFwiKTtcbn0pXG5cbmpRdWVyeShcIi5tZW51IC50aGVtZXMtYnRuXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgalF1ZXJ5KFwiLnRoZW1lcy1jb250YWluZXJcIikudG9nZ2xlKCk7XG4gICAgY2xlYXJUb3AoKTtcbiAgICBqUXVlcnkoXCIudGhlbWVzLWNvbnRhaW5lclwiKS5hZGRDbGFzcyhcIm9uVG9wXCIpO1xufSlcblxualF1ZXJ5KFwiLm1lbnUgLmF0dHJpYnV0aW9uLWJ0blwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgIGpRdWVyeShcIi5hdHRyaWJ1dGlvbi1jb250YWluZXJcIikudG9nZ2xlKCk7XG4gICAgY2xlYXJUb3AoKTtcbiAgICBqUXVlcnkoXCIuYXR0cmlidXRpb24tY29udGFpbmVyXCIpLmFkZENsYXNzKFwib25Ub3BcIik7XG59KVxuIiwiZnVuY3Rpb24gcGFzc2l2ZVBlcmNlcHRpb24oKSB7XG4gICAgY2FsbEFiaWxpdHkoJ3dpcycpO1xuICAgIGpRdWVyeSgnI3Bhc3NQZXJjJykudmFsKHRoaXNBYmlsaXR5Qm9udXMrMTApO1xufVxuIiwidmFyIHByb2ZCID0galF1ZXJ5KCcjcHJvZkJvbnVzJykudmFsKCk7XG5zb21ldGhpbmdDbGV2ZXIoKTtcblxualF1ZXJ5KCcjcHJvZkJvbnVzJykub24oXCJrZXl1cFwiLCBmdW5jdGlvbigpIHtcbiAgICBwcm9mQiA9IGpRdWVyeSgnI3Byb2ZCb251cycpLnZhbCgpO1xuICAgIHNvbWV0aGluZ0NsZXZlcigpO1xufSk7XG5cbmZ1bmN0aW9uIHNvbWV0aGluZ0NsZXZlcigpIHtcbiAgICBqUXVlcnkoJy5pY29uLXByb2YnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xhc3NlcyA9IFsnaWNvbi1wcm9mJywgJ2ljb24tcHJvZiBwcm9maWNpZW50JywgJ2ljb24tcHJvZiBleHBlcnRpc2UnXTtcbiAgICAgICAgdmFyIGN1cnJlbnRDbGFzcyA9IGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycpO1xuICAgICAgICB2YXIgY3VycmVudFBvcyA9IGpRdWVyeS5pbkFycmF5KGN1cnJlbnRDbGFzcywgY2xhc3Nlcyk7XG4gICAgICAgIHZhciBteVByb2YgPSBqUXVlcnkodGhpcykucGFyZW50KCkuY2hpbGRyZW4oJy5wcm9mVmFsJyk7XG4gICAgICAgIHVwZGF0ZVByb2YoalF1ZXJ5KG15UHJvZiksIGN1cnJlbnRQb3MpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVQcm9mKG15UHJvZiwgbXlQcm9mU2tpbGxGbGFnKSB7XG4gICAgdmFyIHRoaXNBYmlsaXR5ID0galF1ZXJ5KG15UHJvZikuYXR0cignaWQnKTtcbiAgICB2YXIgdGhpc0FiaWxpdHlCb251c0lEID0gJyMnICsgdGhpc0FiaWxpdHkgKyAnLUJvbnVzJztcbiAgICB2YXIgdGhpc0FiaWxpdHlCb251cyA9IGpRdWVyeSgnLmFiaWxpdGllcyAnICsgdGhpc0FiaWxpdHlCb251c0lEKS50ZXh0KCk7XG4gICAgdmFyIG5ld1ZhbCA9IHBhcnNlSW50KHRoaXNBYmlsaXR5Qm9udXMpO1xuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMCkge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQodGhpc0FiaWxpdHlCb251cyk7XG4gICAgfVxuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMSkge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQocHJvZkIpICsgcGFyc2VJbnQodGhpc0FiaWxpdHlCb251cyk7XG4gICAgfVxuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMikge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQocHJvZkIpICogMiArIChwYXJzZUludCh0aGlzQWJpbGl0eUJvbnVzKSk7XG4gICAgfVxuICAgIGpRdWVyeShteVByb2YpLnRleHQobmV3VmFsKTtcbn07XG5cblxualF1ZXJ5KCcuaWNvbi1wcm9mJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNsYXNzZXMgPSBbJ2ljb24tcHJvZicsICdpY29uLXByb2YgcHJvZmljaWVudCcsICdpY29uLXByb2YgZXhwZXJ0aXNlJ107XG4gICAgdmFyIGN1cnJlbnRDbGFzcyA9IGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycpO1xuICAgIHZhciBjdXJyZW50UG9zID0galF1ZXJ5LmluQXJyYXkoY3VycmVudENsYXNzLCBjbGFzc2VzKTtcbiAgICB2YXIgbmV3UG9zID0gKChjdXJyZW50UG9zICsgMSkgJSBjbGFzc2VzLmxlbmd0aCk7XG4gICAgdmFyIG5ld0NsYXNzID0gY2xhc3Nlc1tuZXdQb3NdO1xuICAgIGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycsIG5ld0NsYXNzKTtcbiAgICB2YXIgbXlQcm9mID0galF1ZXJ5KHRoaXMpLnBhcmVudCgpLmNoaWxkcmVuKCcucHJvZlZhbCcpO1xuICAgIHVwZGF0ZVByb2YoalF1ZXJ5KG15UHJvZiksIG5ld1Bvcyk7XG59KTtcbiIsImFicnJldmlhdGVMYWJlbHMoKTtcbmpRdWVyeSgnLnRleHRTaXplICNmb250LXNpemUtdXAnKS5jbGljayggZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRhcmdldCA9IGpRdWVyeSh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKTtcbiAgICB2YXIgY3VyclNpemUgPSBwYXJzZUludChqUXVlcnkodGFyZ2V0KS5jc3MoJ2ZvbnRTaXplJykuc3BsaXQoXCJweFwiKVswXSk7XG4gICAgLy8gY3VyclNpemUgPSBNYXRoLnJvdW5kKGN1cnJTaXplKTtcbiAgICB2YXIgbmV3U2l6ZSA9IGN1cnJTaXplKzE7XG4gICAgaWYgKG5ld1NpemUgPiAyNCl7XG4gICAgICAgIG5ld1NpemUgPSAyNDtcbiAgICB9XG4gICAgdmFyIG5ld0VtcyA9IChuZXdTaXplLzE2KTtcbiAgICBjb25zb2xlLmxvZyhjdXJyU2l6ZSsnOicrbmV3U2l6ZSsnOicrbmV3RW1zKTtcbiAgICBqUXVlcnkodGFyZ2V0KS5jc3MoJ2ZvbnRTaXplJyxuZXdFbXMrJ2VtJyk7XG4gICAgYWJycmV2aWF0ZUxhYmVscygpO1xufSlcblxualF1ZXJ5KCcudGV4dFNpemUgI2ZvbnQtc2l6ZS1kb3duJykuY2xpY2soIGZ1bmN0aW9uKCkge1xuICAgIHZhciB0YXJnZXQgPSBqUXVlcnkodGhpcykucGFyZW50KCkucGFyZW50KCk7XG4gICAgdmFyIGN1cnJTaXplID0gcGFyc2VJbnQoalF1ZXJ5KHRhcmdldCkuY3NzKCdmb250U2l6ZScpLnNwbGl0KFwicHhcIilbMF0pO1xuICAgIHZhciBuZXdTaXplID0gY3VyclNpemUtMTtcbiAgICBpZiAobmV3U2l6ZSA8IDkpe1xuICAgICAgICBuZXdTaXplID0gOTtcbiAgICB9XG4gICAgdmFyIG5ld0VtcyA9IChuZXdTaXplLzE2KTtcbiAgICBjb25zb2xlLmxvZyhjdXJyU2l6ZSsnOicrbmV3U2l6ZSsnOicrbmV3RW1zKTtcbiAgICBqUXVlcnkodGFyZ2V0KS5jc3MoJ2ZvbnRTaXplJyxuZXdFbXMrJ2VtJyk7XG4gICAgYWJycmV2aWF0ZUxhYmVscygpO1xufSlcbiIsIi8vdGhlbWVzXG52YXIgYnV0dG9uT3B0aW9ucyA9IFsnZGVmYXVsdCcsICd3b3JuJywgJ2xpZ2h0JywgJ2JsYWNrJywgJ2dyYXknLCAncmVkJ107XG5qUXVlcnkoYnV0dG9uT3B0aW9ucykuZWFjaChmdW5jdGlvbigpIHtcbiAgICB2YXIgbXlTdHlsZSA9IHRoaXM7XG4gICAgdmFyIG15SWQgPSAnIycgKyBteVN0eWxlO1xuICAgIGpRdWVyeShteUlkKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAkKFwiYm9keVwiKS5yZW1vdmVBdHRyKCdjbGFzcycpO1xuICAgICAgICBqUXVlcnkoJ2JvZHknKS5hZGRDbGFzcygndGhlbWUtJyArIG15U3R5bGUpO1xuICAgIH0pXG59KVxuIl19
