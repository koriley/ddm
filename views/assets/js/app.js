"use strict";

function updateAbilityBonus(myAbility) {
  var ability = jQuery(myAbility).val();
  var modifier = jQuery(myAbility).parent().children('.modifier-bubble').text();

  if (!jQuery.isNumeric(ability)) {
    ability = 1;
    jQuery(myAbility).val(ability);
  }

  modifier = Math.floor((ability - 10) / 2);
  jQuery(myAbility).parent().children('.modifier-bubble').text(modifier);
}

;
jQuery(".ability").each(function () {
  updateAbilityBonus(jQuery(this));
  jQuery(this).on("focus", function () {
    jQuery(this).select();
  });
  jQuery(this).on("keyup", function () {
    updateAbilityBonus(jQuery(this));
    updateProf(jQuery('.savingThrows #' + jQuery(this).attr('id')));
  });
});
'use strict'; // remove line below when testing frontend

var fs = require('fs'); // Paths


var campaignListPath = "./campaign.json";
var bookPath = "./book/";
var campaignDirPath = "/campaigns/"; ///
//glodal objects

var books = {};
var npc = {};
var campaigns = {}; ///
//global vars
///

jQuery("document").ready(function () {
  jQuery(".drag").draggable({
    containment: ".mainView",
    scroll: false
  });
});

Object.prototype.hasOwnProperty = function (property) {
  return this[property] !== undefined;
}; // getDirContents("./books").then(function (files) {
//   // console.log();
//   // console.log(JSON.parse(JSON.stringify(files.files[0].name)));
//   for(var i = 0; i <= files.files.length - 1; i++) {
//     readAFile("./books/" + JSON.parse(JSON.stringify(files.files[i].name))).then(function (book) {
//       var bookTitle = JSON.parse(book);
//       console.log(bookTitle.details.name);
//       jQuery(".bookList").append(`<div class="book">${bookTitle.details.name}<div>`);
//        //look for npc, this will eventually be its own function
//       if(bookTitle.hasOwnProperty("NPC")){
//         console.log(bookTitle.details.name+" true")
//       }else{
//         console.log("none found")
//       }
//     });
//   }
// });
"use strict";

function clearTop() {
  jQuery(".drag").each(function () {
    jQuery(this).removeClass("onTop");
  });
}

;
jQuery(".drag").on("mousedown", function () {
  clearTop();
  jQuery(this).addClass("onTop");
});
'use strict';

function readAFile(filepath) {
  return new Promise(function (resolve, reject) {
    fs.readFile(filepath, 'utf-8', function (err, data) {
      if (err) {
        reject("An error ocurred reading the file :" + err.message);
        return;
      } else {
        resolve(data);
      }
    });
  });
}

function writeFile(filepath, data) {
  return new Promise(function (resolve, reject) {
    fs.writeFile(filepath, data, function (err) {
      if (err) {
        reject(err);
      }
    });
  });
}

function getDirContents(dir) {
  return new Promise(function (resolve, reject) {
    var files = {};
    var fileNames = [];

    try {
      fs.readdirSync(dir).forEach(function (fileName) {
        fileNames.push({
          "name": fileName
        });
        files = {
          "files": fileNames
        };
      });
      resolve(files);
    } catch (error) {
      reject(error);
    }
  });
}

function checkFileExist(path) {
  return new Promise(function (resolve, reject) {
    if (!path) {
      reject("Path is invalid " + path);
    }

    try {
      fs.access(path, fs.F_OK, function (err) {
        if (err) {
          resolve("false");
        }

        resolve("true");
      });
    } catch (error) {
      reject("error");
    }
  });
} //write test
// var testObj  = "This is a write test";
// writeFile("../test.txt", testObj);
"use strict";

jQuery(".campaignButton").click(function () {
  var type = jQuery(this).attr("data-campaign");

  if (type == "new") {
    newCampaign();
  } else {
    console.log("coming soon");
  }
});

function newCampaign() {}

function getCampaigns(path) {
  // console.log("getCampaigns " + path);
  checkFileExist(path).then(function (data) {
    // console.log(data);
    if (data == "true") {
      readAFile(path).then(function (campaigns) {
        campaigns = JSON.parse(campaigns);
        console.log(JSON.stringify(campaigns));
        console.log(campaigns.campaigns[0].name);
        var html = "<table>";

        for(var i = 0; i <= campaigns.campaigns - 1; i++) {
          console.log("here " + campaigns.campaigns[i].name);
          html += "<tr><td>" + campaigns.campaigns[i].name + "</td></tr>";
        }

        html += "</table>";
        jQuery(".campaignSelectorBox").html(html);
      });
    }
  });
}
"use strict";

jQuery(".close").click(function () {
  jQuery(this).parent().toggle();
});
jQuery(".menu button").click(function () {
  var openMe = jQuery(this).attr("data-open");
  jQuery("." + openMe).toggle();
  clearTop();
  jQuery("." + openMe).addClass("onTop");
});
"use strict";
"use strict";

var profB = jQuery('#profBonus').val();
somethingClever();
jQuery('#profBonus').on("keyup", function () {
  profB = jQuery('#profBonus').val();
  somethingClever();
});

function somethingClever() {
  jQuery('.icon-prof').each(function () {
    var classes = ['icon-prof', 'icon-prof proficient', 'icon-prof expertise'];
    var currentClass = jQuery(this).attr('class');
    var currentPos = jQuery.inArray(currentClass, classes);
    var myProf = jQuery(this).parent().children('.profVal');
    updateProf(jQuery(myProf), currentPos);
  });
}

function updateProf(myProf, myProfSkillFlag) {
  var thisAbility = jQuery(myProf).attr('id');
  var thisAbilityBonusID = '#' + thisAbility + '-Bonus';
  var thisAbilityBonus = jQuery('.abilities ' + thisAbilityBonusID).text();
  var newVal = parseInt(thisAbilityBonus);

  if (myProfSkillFlag == 0) {
    var newVal = parseInt(thisAbilityBonus);
  }

  if (myProfSkillFlag == 1) {
    var newVal = parseInt(profB) + parseInt(thisAbilityBonus);
  }

  if (myProfSkillFlag == 2) {
    var newVal = parseInt(profB) * 2 + parseInt(thisAbilityBonus);
  }

  jQuery(myProf).text(newVal);
}

;
jQuery('.icon-prof').click(function () {
  var classes = ['icon-prof', 'icon-prof proficient', 'icon-prof expertise'];
  var currentClass = jQuery(this).attr('class');
  var currentPos = jQuery.inArray(currentClass, classes);
  var newPos = (currentPos + 1) % classes.length;
  var newClass = classes[newPos];
  jQuery(this).attr('class', newClass);
  var myProf = jQuery(this).parent().children('.profVal');
  updateProf(jQuery(myProf), newPos);
});
"use strict";

jQuery(document).ready(function () {
  startApp();
});

function startApp() {
  getCampaigns(campaignListPath);
}
"use strict";

//themes
var buttonOptions = ['default', 'black', 'gray', 'light', 'red'];
jQuery(buttonOptions).each(function () {
  var myStyle = this;
  var myId = '#' + myStyle;
  jQuery(myId).on("click", function () {
    $("body").removeAttr('class');
    jQuery('body').addClass('theme-' + myStyle);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFiaWxpdHlCb251cy5qcyIsImFwcC5qcyIsImNsaWNrVG9Gcm9udC5qcyIsImlvLmpzIiwibG9hZENhbXBhaWduLmpzIiwibWVudUJ1dHRvbnMuanMiLCJucGMuanMiLCJwcm9maWNpZW5jaWVzLmpzIiwic3RhcnR1cC5qcyIsInRoZW1lcy5qcyJdLCJuYW1lcyI6WyJ1cGRhdGVBYmlsaXR5Qm9udXMiLCJteUFiaWxpdHkiLCJhYmlsaXR5IiwialF1ZXJ5IiwidmFsIiwibW9kaWZpZXIiLCJwYXJlbnQiLCJjaGlsZHJlbiIsInRleHQiLCJpc051bWVyaWMiLCJNYXRoIiwiZmxvb3IiLCJlYWNoIiwib24iLCJzZWxlY3QiLCJ1cGRhdGVQcm9mIiwiYXR0ciIsImZzIiwicmVxdWlyZSIsImNhbXBhaWduTGlzdFBhdGgiLCJib29rUGF0aCIsImNhbXBhaWduRGlyUGF0aCIsImJvb2tzIiwibnBjIiwiY2FtcGFpZ25zIiwicmVhZHkiLCJkcmFnZ2FibGUiLCJjb250YWlubWVudCIsInNjcm9sbCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicHJvcGVydHkiLCJ1bmRlZmluZWQiLCJjbGVhclRvcCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJyZWFkQUZpbGUiLCJmaWxlcGF0aCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicmVhZEZpbGUiLCJlcnIiLCJkYXRhIiwibWVzc2FnZSIsIndyaXRlRmlsZSIsImdldERpckNvbnRlbnRzIiwiZGlyIiwiZmlsZXMiLCJmaWxlTmFtZXMiLCJyZWFkZGlyU3luYyIsImZvckVhY2giLCJmaWxlTmFtZSIsInB1c2giLCJlcnJvciIsImNoZWNrRmlsZUV4aXN0IiwicGF0aCIsImFjY2VzcyIsIkZfT0siLCJjbGljayIsInR5cGUiLCJuZXdDYW1wYWlnbiIsImNvbnNvbGUiLCJsb2ciLCJnZXRDYW1wYWlnbnMiLCJ0aGVuIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwibmFtZSIsImh0bWwiLCJpIiwidG9nZ2xlIiwib3Blbk1lIiwicHJvZkIiLCJzb21ldGhpbmdDbGV2ZXIiLCJjbGFzc2VzIiwiY3VycmVudENsYXNzIiwiY3VycmVudFBvcyIsImluQXJyYXkiLCJteVByb2YiLCJteVByb2ZTa2lsbEZsYWciLCJ0aGlzQWJpbGl0eSIsInRoaXNBYmlsaXR5Qm9udXNJRCIsInRoaXNBYmlsaXR5Qm9udXMiLCJuZXdWYWwiLCJwYXJzZUludCIsIm5ld1BvcyIsImxlbmd0aCIsIm5ld0NsYXNzIiwiZG9jdW1lbnQiLCJzdGFydEFwcCIsImJ1dHRvbk9wdGlvbnMiLCJteVN0eWxlIiwibXlJZCIsIiQiLCJyZW1vdmVBdHRyIl0sIm1hcHBpbmdzIjoiOztBQUNBLFNBQVNBLGtCQUFULENBQTRCQyxTQUE1QixFQUF1QztBQUNuQyxNQUFJQyxPQUFPLEdBQUdDLE1BQU0sQ0FBQ0YsU0FBRCxDQUFOLENBQWtCRyxHQUFsQixFQUFkO0FBRUEsTUFBSUMsUUFBUSxHQUFHRixNQUFNLENBQUNGLFNBQUQsQ0FBTixDQUFrQkssTUFBbEIsR0FBMkJDLFFBQTNCLENBQW9DLGtCQUFwQyxFQUF3REMsSUFBeEQsRUFBZjs7QUFDQSxNQUFJLENBQUNMLE1BQU0sQ0FBQ00sU0FBUCxDQUFpQlAsT0FBakIsQ0FBTCxFQUFnQztBQUM1QkEsSUFBQUEsT0FBTyxHQUFHLENBQVY7QUFDQUMsSUFBQUEsTUFBTSxDQUFDRixTQUFELENBQU4sQ0FBa0JHLEdBQWxCLENBQXNCRixPQUF0QjtBQUNIOztBQUVERyxFQUFBQSxRQUFRLEdBQUdLLElBQUksQ0FBQ0MsS0FBTCxDQUFXLENBQUNULE9BQU8sR0FBRyxFQUFYLElBQWlCLENBQTVCLENBQVg7QUFDQUMsRUFBQUEsTUFBTSxDQUFDRixTQUFELENBQU4sQ0FBa0JLLE1BQWxCLEdBQTJCQyxRQUEzQixDQUFvQyxrQkFBcEMsRUFBd0RDLElBQXhELENBQTZESCxRQUE3RDtBQUNIOztBQUFBO0FBR0RGLE1BQU0sQ0FBQyxVQUFELENBQU4sQ0FBbUJTLElBQW5CLENB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R0FBc0JDLFFBQXRCLENBQStCLFVBQS9CLENBQWI7QUFDQVEsRUFBQUEsVUFBVSxDQUFDWixNQUFNLENBQUM4RSxNQUFELENBQVAsRUFBaUJPLE1BQWpCLENBQVY7QUFDSCxDQVREOzs7QUNwQ0FyRixNQUFNLENBQUN3RixRQUFELENBQU4sQ0FBaUJsRSxLQUFqQixDQUF1QixZQUFVO0FBRS9CbUUsRUFBQUEsUUFBUTtBQUVQLENBSkg7O0FBT0UsU0FBU0EsUUFBVCxHQUFtQjtBQUNqQjNCLEVBQUFBLFlBQVksQ0FBQzlDLGdCQUFELENBQVo7QUFDRDs7O0FDVEg7QUFDQSxJQUFJMEUsYUFBYSxHQUFHLENBQUMsU0FBRCxFQUFZLE9BQVosRUFBcUIsTUFBckIsRUFBNkIsT0FBN0IsRUFBc0MsS0FBdEMsQ0FBcEI7QUFDQTFGLE1BQU0sQ0FBQzBGLGFBQUQsQ0FBTixDQUFzQmpGLElBQXRCLENBQTJCLFlBQVc7QUFDbEMsTUFBSWtGLE9BQU8sR0FBRyxJQUFkO0FBQ0EsTUFBSUMsSUFBSSxHQUFHLE1BQU1ELE9BQWpCO0FBQ0EzRixFQUFBQSxNQUFNLENBQUM0RixJQUFELENBQU4sQ0FBYWxGLEVBQWIsQ0FBZ0IsT0FBaEIsRUFBeUIsWUFBVztBQUNoQ21GLElBQUFBLENBQUMsQ0FBQyxNQUFELENBQUQsQ0FBVUMsVUFBVixDQUFxQixPQUFyQjtBQUNBOUYsSUFBQUEsTUFBTSxDQUFDLE1BQUQsQ0FBTixDQUFlaUMsUUFBZixDQUF3QixXQUFXMEQsT0FBbkM7QUFDSCxHQUhEO0FBSUgsQ0FQRCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmZ1bmN0aW9uIHVwZGF0ZUFiaWxpdHlCb251cyhteUFiaWxpdHkpIHtcbiAgICB2YXIgYWJpbGl0eSA9IGpRdWVyeShteUFiaWxpdHkpLnZhbCgpO1xuXG4gICAgdmFyIG1vZGlmaWVyID0galF1ZXJ5KG15QWJpbGl0eSkucGFyZW50KCkuY2hpbGRyZW4oJy5tb2RpZmllci1idWJibGUnKS50ZXh0KCk7XG4gICAgaWYgKCFqUXVlcnkuaXNOdW1lcmljKGFiaWxpdHkpKSB7XG4gICAgICAgIGFiaWxpdHkgPSAxO1xuICAgICAgICBqUXVlcnkobXlBYmlsaXR5KS52YWwoYWJpbGl0eSk7XG4gICAgfVxuXG4gICAgbW9kaWZpZXIgPSBNYXRoLmZsb29yKChhYmlsaXR5IC0gMTApIC8gMik7XG4gICAgalF1ZXJ5KG15QWJpbGl0eSkucGFyZW50KCkuY2hpbGRyZW4oJy5tb2RpZmllci1idWJibGUnKS50ZXh0KG1vZGlmaWVyKTtcbn07XG5cblxualF1ZXJ5KFwiLmFiaWxpdHlcIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICB1cGRhdGVBYmlsaXR5Qm9udXMoalF1ZXJ5KHRoaXMpKTtcblxuICAgIGpRdWVyeSh0aGlzKS5vbihcImZvY3VzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBqUXVlcnkodGhpcykuc2VsZWN0KCk7XG4gICAgfSlcbiAgICBqUXVlcnkodGhpcykub24oXCJrZXl1cFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdXBkYXRlQWJpbGl0eUJvbnVzKGpRdWVyeSh0aGlzKSk7XG4gICAgICAgIHVwZGF0ZVByb2YoalF1ZXJ5KCcuc2F2aW5nVGhyb3dzICMnK2pRdWVyeSh0aGlzKS5hdHRyKCdpZCcpKSk7XG4gICAgfSk7XG59KTtcbiIsIid1c2Ugc3RyaWN0JztcbiAgLy8gcmVtb3ZlIGxpbmUgYmVsb3cgd2hlbiB0ZXN0aW5nIGZyb250ZW5kXG4gIHZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG4gIFxuLy8gUGF0aHNcbmxldCBjYW1wYWlnbkxpc3RQYXRoID0gXCIuL2NhbXBhaWduLmpzb25cIjtcbmxldCBib29rUGF0aCA9IFwiLi9ib29rL1wiO1xubGV0IGNhbXBhaWduRGlyUGF0aCA9IFwiL2NhbXBhaWducy9cIjtcblxuLy8vXG5cbi8vZ2xvZGFsIG9iamVjdHNcbnZhciBib29rcyA9IHt9O1xudmFyIG5wYyA9IHt9O1xudmFyIGNhbXBhaWducyA9IHt9O1xuLy8vXG5cbi8vZ2xvYmFsIHZhcnNcblxuLy8vXG5cblxuXG5qUXVlcnkoXCJkb2N1bWVudFwiKS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gIGpRdWVyeShcIi5kcmFnXCIpLmRyYWdnYWJsZSh7XG4gICAgICBjb250YWlubWVudDogXCIubWFpblZpZXdcIixcbiAgICAgIHNjcm9sbDogZmFsc2VcbiAgfSk7XG59KTtcblxuT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSA9IGZ1bmN0aW9uKHByb3BlcnR5KSB7XG5yZXR1cm4gdGhpc1twcm9wZXJ0eV0gIT09IHVuZGVmaW5lZDtcbn07XG5cbi8vIGdldERpckNvbnRlbnRzKFwiLi9ib29rc1wiKS50aGVuKGZ1bmN0aW9uIChmaWxlcykge1xuLy8gICAvLyBjb25zb2xlLmxvZygpO1xuLy8gICAvLyBjb25zb2xlLmxvZyhKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGZpbGVzLmZpbGVzWzBdLm5hbWUpKSk7XG4vLyAgIGZvcih2YXIgaSA9IDA7IGkgPD0gZmlsZXMuZmlsZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4vLyAgICAgcmVhZEFGaWxlKFwiLi9ib29rcy9cIiArIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZmlsZXMuZmlsZXNbaV0ubmFtZSkpKS50aGVuKGZ1bmN0aW9uIChib29rKSB7XG4vLyAgICAgICB2YXIgYm9va1RpdGxlID0gSlNPTi5wYXJzZShib29rKTtcbi8vICAgICAgIGNvbnNvbGUubG9nKGJvb2tUaXRsZS5kZXRhaWxzLm5hbWUpO1xuLy8gICAgICAgalF1ZXJ5KFwiLmJvb2tMaXN0XCIpLmFwcGVuZChgPGRpdiBjbGFzcz1cImJvb2tcIj4ke2Jvb2tUaXRsZS5kZXRhaWxzLm5hbWV9PGRpdj5gKTtcblxuLy8gICAgICAgIC8vbG9vayBmb3IgbnBjLCB0aGlzIHdpbGwgZXZlbnR1YWxseSBiZSBpdHMgb3duIGZ1bmN0aW9uXG4vLyAgICAgICBpZihib29rVGl0bGUuaGFzT3duUHJvcGVydHkoXCJOUENcIikpe1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhib29rVGl0bGUuZGV0YWlscy5uYW1lK1wiIHRydWVcIilcbi8vICAgICAgIH1lbHNle1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhcIm5vbmUgZm91bmRcIilcbi8vICAgICAgIH1cblxuLy8gICAgIH0pO1xuICAgXG5cblxuLy8gICB9XG4vLyB9KTtcblxuIiwiZnVuY3Rpb24gY2xlYXJUb3AoKSB7XG4gICAgalF1ZXJ5KFwiLmRyYWdcIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgalF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKFwib25Ub3BcIik7XG4gICAgfSk7XG59O1xuXG5qUXVlcnkoXCIuZHJhZ1wiKS5vbihcIm1vdXNlZG93blwiLCBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRvcCgpO1xuICAgIGpRdWVyeSh0aGlzKS5hZGRDbGFzcyhcIm9uVG9wXCIpO1xufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIHJlYWRBRmlsZShmaWxlcGF0aCl7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgZnMucmVhZEZpbGUoZmlsZXBhdGgsICd1dGYtOCcsIGZ1bmN0aW9uKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIkFuIGVycm9yIG9jdXJyZWQgcmVhZGluZyB0aGUgZmlsZSA6XCIgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gd3JpdGVGaWxlKGZpbGVwYXRoLCBkYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGZzLndyaXRlRmlsZShmaWxlcGF0aCwgZGF0YSwgKGVycikgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gZ2V0RGlyQ29udGVudHMoZGlyKXtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgdmFyIGZpbGVzID0ge307XG4gICAgICAgIHZhciBmaWxlTmFtZXMgPSBbXTtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgZnMucmVhZGRpclN5bmMoZGlyKS5mb3JFYWNoKChmaWxlTmFtZSk9PntcbiAgICAgICAgICAgICAgICBmaWxlTmFtZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOmZpbGVOYW1lXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBmaWxlcyA9IHtcImZpbGVzXCI6ZmlsZU5hbWVzfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlc29sdmUoZmlsZXMpO1xuICAgICAgICB9Y2F0Y2goZXJyb3Ipe1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBjaGVja0ZpbGVFeGlzdChwYXRoKXtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICBpZighcGF0aCl7XG4gICAgICAgICAgICAgcmVqZWN0KFwiUGF0aCBpcyBpbnZhbGlkIFwiK3BhdGgpXG4gICAgICAgIH1cbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgZnMuYWNjZXNzKHBhdGgsIGZzLkZfT0ssIChlcnIpPT57XG4gICAgICAgICAgICAgICAgaWYoZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcImZhbHNlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXNvbHZlKFwidHJ1ZVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9Y2F0Y2ggKGVycm9yKXtcbiAgICAgICAgICAgIHJlamVjdChcImVycm9yXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4vL3dyaXRlIHRlc3Rcbi8vIHZhciB0ZXN0T2JqICA9IFwiVGhpcyBpcyBhIHdyaXRlIHRlc3RcIjtcbi8vIHdyaXRlRmlsZShcIi4uL3Rlc3QudHh0XCIsIHRlc3RPYmopO1xuIiwialF1ZXJ5KFwiLmNhbXBhaWduQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdHlwZSA9IGpRdWVyeSh0aGlzKS5hdHRyKFwiZGF0YS1jYW1wYWlnblwiKTtcbiAgICBpZiAodHlwZSA9PSBcIm5ld1wiKSB7XG4gICAgICAgIG5ld0NhbXBhaWduKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjb21pbmcgc29vblwiKTtcbiAgICB9XG59KTtcblxuXG5mdW5jdGlvbiBuZXdDYW1wYWlnbigpIHtcblxuXG59XG5cbmZ1bmN0aW9uIGdldENhbXBhaWducyhwYXRoKSB7XG4gICAgLy8gY29uc29sZS5sb2coXCJnZXRDYW1wYWlnbnMgXCIgKyBwYXRoKTtcbiAgICBjaGVja0ZpbGVFeGlzdChwYXRoKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICBpZiAoZGF0YSA9PSBcInRydWVcIikge1xuICAgICAgICAgICAgcmVhZEFGaWxlKHBhdGgpLnRoZW4oKGNhbXBhaWducykgPT4ge1xuICAgICAgICAgICAgICAgIGNhbXBhaWducyA9IEpTT04ucGFyc2UoY2FtcGFpZ25zKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShjYW1wYWlnbnMpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjYW1wYWlnbnMuY2FtcGFpZ25zWzBdLm5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBodG1sID0gXCI8dGFibGU+XCI7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8PSBjYW1wYWlnbnMuY2FtcGFpZ25zIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGVyZSBcIiArIGNhbXBhaWducy5jYW1wYWlnbnNbaV0ubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBcIjx0cj48dGQ+XCIgKyBjYW1wYWlnbnMuY2FtcGFpZ25zW2ldLm5hbWUgKyBcIjwvdGQ+PC90cj5cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaHRtbCArPSBcIjwvdGFibGU+XCI7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KFwiLmNhbXBhaWduU2VsZWN0b3JCb3hcIikuaHRtbChodG1sKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn0iLCJqUXVlcnkoXCIuY2xvc2VcIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgIGpRdWVyeSh0aGlzKS5wYXJlbnQoKS50b2dnbGUoKTtcbn0pXG5qUXVlcnkoXCIubWVudSBidXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgIHZhciBvcGVuTWUgPSBqUXVlcnkodGhpcykuYXR0cihcImRhdGEtb3BlblwiKTtcbiAgICBqUXVlcnkoXCIuXCIgKyBvcGVuTWUpLnRvZ2dsZSgpO1xuICAgIGNsZWFyVG9wKCk7XG4gICAgalF1ZXJ5KFwiLlwiICsgb3Blbk1lKS5hZGRDbGFzcyhcIm9uVG9wXCIpO1xufSk7IiwiIiwidmFyIHByb2ZCID0galF1ZXJ5KCcjcHJvZkJvbnVzJykudmFsKCk7XG5zb21ldGhpbmdDbGV2ZXIoKTtcblxualF1ZXJ5KCcjcHJvZkJvbnVzJykub24oXCJrZXl1cFwiLCBmdW5jdGlvbigpIHtcbiAgICBwcm9mQiA9IGpRdWVyeSgnI3Byb2ZCb251cycpLnZhbCgpO1xuICAgIHNvbWV0aGluZ0NsZXZlcigpO1xufSk7XG5cbmZ1bmN0aW9uIHNvbWV0aGluZ0NsZXZlcigpIHtcbiAgICBqUXVlcnkoJy5pY29uLXByb2YnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xhc3NlcyA9IFsnaWNvbi1wcm9mJywgJ2ljb24tcHJvZiBwcm9maWNpZW50JywgJ2ljb24tcHJvZiBleHBlcnRpc2UnXTtcbiAgICAgICAgdmFyIGN1cnJlbnRDbGFzcyA9IGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycpO1xuICAgICAgICB2YXIgY3VycmVudFBvcyA9IGpRdWVyeS5pbkFycmF5KGN1cnJlbnRDbGFzcywgY2xhc3Nlcyk7XG4gICAgICAgIHZhciBteVByb2YgPSBqUXVlcnkodGhpcykucGFyZW50KCkuY2hpbGRyZW4oJy5wcm9mVmFsJyk7XG4gICAgICAgIHVwZGF0ZVByb2YoalF1ZXJ5KG15UHJvZiksIGN1cnJlbnRQb3MpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVQcm9mKG15UHJvZiwgbXlQcm9mU2tpbGxGbGFnKSB7XG4gICAgdmFyIHRoaXNBYmlsaXR5ID0galF1ZXJ5KG15UHJvZikuYXR0cignaWQnKTtcbiAgICB2YXIgdGhpc0FiaWxpdHlCb251c0lEID0gJyMnICsgdGhpc0FiaWxpdHkgKyAnLUJvbnVzJztcbiAgICB2YXIgdGhpc0FiaWxpdHlCb251cyA9IGpRdWVyeSgnLmFiaWxpdGllcyAnICsgdGhpc0FiaWxpdHlCb251c0lEKS50ZXh0KCk7XG4gICAgdmFyIG5ld1ZhbCA9IHBhcnNlSW50KHRoaXNBYmlsaXR5Qm9udXMpO1xuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMCkge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQodGhpc0FiaWxpdHlCb251cyk7XG4gICAgfVxuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMSkge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQocHJvZkIpICsgcGFyc2VJbnQodGhpc0FiaWxpdHlCb251cyk7XG4gICAgfVxuICAgIGlmIChteVByb2ZTa2lsbEZsYWcgPT0gMikge1xuICAgICAgICB2YXIgbmV3VmFsID0gcGFyc2VJbnQocHJvZkIpICogMiArIChwYXJzZUludCh0aGlzQWJpbGl0eUJvbnVzKSk7XG4gICAgfVxuICAgIGpRdWVyeShteVByb2YpLnRleHQobmV3VmFsKTtcbn07XG5cblxualF1ZXJ5KCcuaWNvbi1wcm9mJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNsYXNzZXMgPSBbJ2ljb24tcHJvZicsICdpY29uLXByb2YgcHJvZmljaWVudCcsICdpY29uLXByb2YgZXhwZXJ0aXNlJ107XG4gICAgdmFyIGN1cnJlbnRDbGFzcyA9IGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycpO1xuICAgIHZhciBjdXJyZW50UG9zID0galF1ZXJ5LmluQXJyYXkoY3VycmVudENsYXNzLCBjbGFzc2VzKTtcbiAgICB2YXIgbmV3UG9zID0gKChjdXJyZW50UG9zICsgMSkgJSBjbGFzc2VzLmxlbmd0aCk7XG4gICAgdmFyIG5ld0NsYXNzID0gY2xhc3Nlc1tuZXdQb3NdO1xuICAgIGpRdWVyeSh0aGlzKS5hdHRyKCdjbGFzcycsIG5ld0NsYXNzKTtcbiAgICB2YXIgbXlQcm9mID0galF1ZXJ5KHRoaXMpLnBhcmVudCgpLmNoaWxkcmVuKCcucHJvZlZhbCcpO1xuICAgIHVwZGF0ZVByb2YoalF1ZXJ5KG15UHJvZiksIG5ld1Bvcyk7XG59KTtcbiIsImpRdWVyeShkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgXG4gIHN0YXJ0QXBwKCk7XG4gXG4gIH0pXG5cblxuICBmdW5jdGlvbiBzdGFydEFwcCgpe1xuICAgIGdldENhbXBhaWducyhjYW1wYWlnbkxpc3RQYXRoKTtcbiAgfSIsIi8vdGhlbWVzXG52YXIgYnV0dG9uT3B0aW9ucyA9IFsnZGVmYXVsdCcsICdibGFjaycsICdncmF5JywgJ2xpZ2h0JywgJ3JlZCddO1xualF1ZXJ5KGJ1dHRvbk9wdGlvbnMpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgdmFyIG15U3R5bGUgPSB0aGlzO1xuICAgIHZhciBteUlkID0gJyMnICsgbXlTdHlsZTtcbiAgICBqUXVlcnkobXlJZCkub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJChcImJvZHlcIikucmVtb3ZlQXR0cignY2xhc3MnKTtcbiAgICAgICAgalF1ZXJ5KCdib2R5JykuYWRkQ2xhc3MoJ3RoZW1lLScgKyBteVN0eWxlKTtcbiAgICB9KVxufSlcbiJdfQ==